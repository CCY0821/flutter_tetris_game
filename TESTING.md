# 🎯 Flutter Tetris - 官方得分系統測試指南

## 🆕 新增功能概覽

### 📊 官方得分系統
基於 [Tetris.wiki](https://tetris.wiki/Scoring) 現代指導原則實現：

- **標準消行得分**：Single(100) → Double(300) → Triple(500) → Tetris(800) × 等級
- **T-Spin 系統**：Mini T-Spin(100-200) → T-Spin(400-1600) 依類型和消行數
- **Combo 獎勵**：50 × Combo數 × 等級，鼓勵連續消除
- **Back-to-Back**：困難消除的 1.5倍 獎勵（Tetris/T-Spin）
- **軟降/硬降**：軟降1分/格，硬降2分/格

### 🔥 官方連擊系統
基於 [Tetris.wiki/Combo](https://tetris.wiki/Combo) 官方規範實現：

- **標準計數**：從 -1 開始，消行 +1，無消行重置為 -1
- **6 級連擊等級**：Nice(1-3) → Great(4-6) → Excellent(7-10) → Amazing(11-15) → Incredible(16-20) → LEGENDARY(21+)
- **動態視覺**：連擊等級對應不同顏色和特效
- **音效分層**：一般連擊和高連擊不同音效
- **統計追蹤**：當前/最大連擊、總次數、積分統計

### 🎨 新增 UI 元素
- **得分詳情面板**：顯示最後得分和成就
- **連擊指示器**：動態顏色的連擊狀態顯示
- **連擊特效框**：4+ 連擊的漸變發光特效
- **連擊統計面板**：完整的連擊數據追蹤
- **成就等級條**：6 級連擊成就視覺化
- **B2B 指示器**：顯示 Back-to-Back 準備狀態

## 🚀 本地測試環境

### 快速啟動
```bash
# 1. 編譯 Web 版本
flutter build web

# 2. 啟動本地伺服器
node simple_server.js

# 3. 開啟瀏覽器
# 訪問: http://localhost:3000
```

### 測試重點

#### 1. 基礎得分驗證
- **單行消除**：應顯示 100 × 當前等級 分數
- **雙行消除**：應顯示 300 × 當前等級 分數  
- **三行消除**：應顯示 500 × 當前等級 分數
- **四行消除（Tetris）**：應顯示 800 × 當前等級 分數

#### 2. 🔥 連擊系統測試
##### 基礎連擊功能
- **計數邏輯**：從 -1 開始，消行 +1，無消行重置為 -1
- **顯示邏輯**：UI 顯示 max(0, combo_count)
- **得分公式**：50 × 顯示的Combo數 × 等級

##### 6 級連擊視覺測試
| Combo 數 | 等級 | 期望顏色 | 測試重點 |
|----------|------|----------|----------|
| 1-3 | Nice | 藍色 🔵 | 基礎指示器 |
| 4-6 | Great | 綠色 🟢 | 特效框出現 |
| 7-10 | Excellent | 黃色 🟡 | 明顯顏色變化 |
| 11-15 | Amazing | 橙色 🟠 | 高級視覺效果 |
| 16-20 | Incredible | 橙紅色 🔴 | 極致特效 |
| 21+ | LEGENDARY | 深紅色 🔴 | 傳奇級效果 |

##### 連擊統計面板測試
- **當前連擊**：即時數值更新
- **最大連擊**：歷史記錄 🏆
- **總連擊次數**：累積統計
- **連擊積分**：獎勵分數統計
- **成就等級條**：6 級進度顯示

#### 3. Back-to-Back 測試
- 連續 Tetris 應顯示 "B2B" 指示器
- 獎勵分數應為基礎分數的 1.5倍
- 非困難消除後 B2B 狀態應重置

#### 4. 軟降/硬降測試
- **軟降**：按住 ↓ 鍵，每下降一格 +1 分
- **硬降**：按空白鍵，每下降一格 +2 分

#### 5. T-Spin 測試 (進階)
- T 方塊透過旋轉進行消除
- 應顯示 "T-Spin" 相關成就
- 得分應根據 T-Spin 類型和消行數計算

#### 6. 🎵 音效系統測試
- **音效優先級**：T-Spin > 高連擊(4+) > 一般連擊 > Tetris > 標準消行
- **連擊音效**：1-3連擊播放 `combo`，4+連擊播放 `combo_high`

### 測試數據記錄

建議記錄以下項目：

```
測試項目：[基礎得分/Combo/B2B/T-Spin]
期望結果：[預期分數或行為]
實際結果：[觀察到的結果]
狀態：[通過/失敗/部分通過]
備註：[其他觀察]
```

## 🎮 控制指南

### 基本操作
- **← →** 左右移動
- **↑** 順時針旋轉
- **Z** 逆時針旋轉  
- **↓** 軟降（測試軟降得分）
- **空白鍵** 硬降（測試硬降得分）
- **P** 暫停/恢復

### 測試技巧
1. **製造 Tetris**：保留右側空間，用 I 方塊製造四行消除
2. **連續消除**：快速連續操作測試 Combo 系統
3. **T-Spin 設置**：用 T 方塊卡在狹窄空間中測試旋轉消除

## 🔧 疑難排解

### 常見問題
- **頁面空白**：確認伺服器運行中，檢查控制台錯誤
- **得分不正確**：檢查等級是否正確，是否有 Combo/B2B 加成
- **UI 元素缺失**：確認是否為最新版本，重新整理頁面

### 調試工具
- 瀏覽器開發者工具 (F12)
- Flutter Web DevTools
- 控制台錯誤訊息

## 📊 預期測試結果

### 基準測試案例
1. **等級1，單行消除**：100分 + 軟降/硬降分數
2. **等級2，雙行消除**：600分 (300×2)
3. **等級1，Tetris+Combo**：800 + 50×1×1 = 850分
4. **連續兩次Tetris**：第二次應有B2B獎勵 (800×1.5 = 1200分)

### 🔥 連擊測試案例
1. **基礎連擊（等級1）**：
   - 連擊1：50×1×1 = 50分獎勵
   - 連擊2：50×2×1 = 100分獎勵
   - 連擊3：50×3×1 = 150分獎勵

2. **高級連擊（等級2）**：
   - 連擊7（Excellent）：50×7×2 = 700分獎勵 + 黃色特效
   - 連擊15（Amazing）：50×15×2 = 1500分獎勵 + 橙色特效

3. **傳奇連擊（等級1）**：
   - 連擊21（LEGENDARY）：50×21×1 = 1050分獎勵 + 深紅特效

---

🎯 **測試目標**：確認新的官方得分系統和連擊系統運作正確，UI 顯示準確，視覺特效流暢。

🚀 **回報問題**：發現任何異常請記錄詳細情況，包括操作步驟、期望結果和實際結果。